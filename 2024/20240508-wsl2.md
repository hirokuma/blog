# 2024/05/08

## WSL2のmirroredネットワークモード

WSL2でサーバを立て、そこにスマホでアクセスしたいことがあった。  
WSL1のときは特に何もせずにできたのだが、WSL2は何かしないとダメだそうだ。

[WSL を使用したネットワーク アプリケーションへのアクセス | Microsoft Learn](https://learn.microsoft.com/ja-jp/windows/wsl/networking)

下の方に「[ミラーモードのネットワーク]([WSL を使用したネットワーク アプリケーションへのアクセス | Microsoft Learn](https://learn.microsoft.com/ja-jp/windows/wsl/networking))」という項目がある。  
いくつか制約はあるものの、dockerなどを使わずに動かしたサーバであればホスト側、つまりWindowsのIPアドレスおよびポートでアクセスできるようになる。

設定方法は、`.wslconfig`ファイルに設定を書くこと。

```text
[wsl2]
networkingMode=mirrored
```

この`.wslconfig`ファイルだが、これはWindows側の`c:\Users\<hoge>\.wslconfig`のようなファイルになる。デフォルトではファイルはないので作る。  
最初に見たサイトで`~/.wslconfig`となっていたからWSL2にログインして作っていたのだが、そうではないのだ。そこに書いても意味はない。  
mirroredの設定が反映されたかどうかは`ip a`などでIPアドレスを出力させるとわかる。  
うちではWindowsは`192.168.0.x`のようなアドレスで、WSL2は`172.17.x.y`のようなアドレスになっていた。mirroredが有効になるとWSL2もWindows側と同じアドレスとして見えるようになった。
